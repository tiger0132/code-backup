# A

## 题意

给一个括号序列，每次操作可以选择一个区间，把它重排，代价是区间的长度。最小化让括号序列合法的代价。

## 解法

先判解是否存在，然后考虑把前缀和之后所有的负数重排掉。答案是负数个数 + 负数段数。

# B

## 题意

给一个序列 $a_i$，求 $\bigoplus_{i=1}^{n-1}\bigoplus_{j=i+1}^n(a_i+a_j)$。

## 解法

对每一位分开考虑。如果存在两个数 $x,y$ 满足 $(x\bmod 2^k)+(y\bmod 2^k)\in[2^k,2^{k+1}-1]\cup[2^k+2^{k+1},2^{k+2}-2]$，那么 $x+y$ 会对 $2^k$ 这一位产生贡献。

然后随便拿个数据结构维护一下……

# C

## 题意

给一个二分图，右部点带权，定义 $f(S)$ 为与左部点集 $S$ 相邻的所有右部点的点权和。求 $\gcd_S f(S)$。

## 解法

对于某个右部点 $x$，设 $g(x)=\{y\mid x\in f(\{y\})\}$。如果 $g(x)=g(y)$，那么 $x$ 和 $y$ 可以合并成一个新点，权值为 $x,y$ 的权值和。而且孤立点可以移除。

合并完之后，对于任意一个右部点 $x$，都存在两个左部点集 $S,T$ 使得 $f(S)\cap f(T)=\{x\}$。注意到 $\gcd(a+b,b+c,a+b+c)=\gcd(a,b,c),\gcd(a+b,b)=\gcd(a,b)$，所以剩下的点的 $\gcd$ 和即为答案。

# D

## 题意

略。

## 解法

首先注意到顺序是不影响答案的。然后考虑把序列翻转，于是就要找到一个 $a$ 的不下降序列。

设 $dp_{i,j,k}$ 为前 $i$ 个数，最大值 $j$ 出现了 $k$ 次时的答案。那么插入数字 $a_i$ 之后，
